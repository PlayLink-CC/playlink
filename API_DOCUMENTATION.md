# PlayLink - API Integration Reference\n\n## API Overview\n\nPlayLink communicates with a Node.js/Express backend API running on `http://localhost:3000`. This document details all API endpoints used by the frontend application.\n\n## Base URL\n\n```\nhttp://localhost:3000/api\n```\n\n## Authentication\n\n### Login-based Authentication\n- Uses HTTP POST with email/password\n- Backend returns HTTP-only cookies for session management\n- Credentials must be included: `credentials: 'include'`\n- Protected endpoints require active session\n\n## API Endpoints\n\n### 1. Venues API\n\n#### Get All Venues\n```\nGET /venues\n```\n\n**Description**: Retrieve all available sports venues\n\n**Query Parameters**:\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| search | string | No | Search by sport name or venue name |\n\n**Response (200 OK)**:\n```json\n[\n  {\n    \"venue_id\": \"uuid-1234\",\n    \"venue_name\": \"Elite Basketball Court\",\n    \"location\": \"Downtown District\",\n    \"price_per_hour\": 40,\n    \"amenities\": \"Changing Rooms, Parking Available, Equipment Rental\",\n    \"primary_image\": \"https://example.com/image.jpg\",\n    \"rating\": 4.5,\n    \"total_bookings\": 125\n  }\n]\n```\n\n**Error Responses**:\n- `400 Bad Request`: Invalid search parameters\n- `500 Internal Server Error`: Server error\n\n**Used In**: `Venue.jsx`, `SearchForm.jsx`\n\n**Example Usage**:\n```javascript\n// Get all venues\nconst response = await axios.get(\"http://localhost:3000/api/venues\");\n\n// Search venues\nconst response = await axios.get(\"http://localhost:3000/api/venues\", {\n  params: { search: \"basketball\" }\n});\n```\n\n---\n\n#### Get Trending Venues (Top Weekly)\n```\nGET /venues/top-weekly\n```\n\n**Description**: Retrieve top-booked venues for the current week\n\n**Query Parameters**: None\n\n**Response (200 OK)**:\n```json\n[\n  {\n    \"venue_id\": \"uuid-1234\",\n    \"venue_name\": \"Elite Basketball Court\",\n    \"location\": \"Downtown District\",\n    \"price_per_hour\": 40,\n    \"amenities\": \"Changing Rooms, Parking Available, Equipment Rental\",\n    \"primary_image\": \"https://example.com/image.jpg\",\n    \"rating\": 4.5,\n    \"booking_count_this_week\": 45\n  }\n]\n```\n\n**Used In**: `Home.jsx`\n\n**Example Usage**:\n```javascript\nconst response = await axios.get(\"http://localhost:3000/api/venues/top-weekly\");\nsetVenues(response.data);\n```\n\n---\n\n#### Get Venue Details by ID (Future)\n```\nGET /venues/:id\n```\n\n**Description**: Retrieve detailed information about a specific venue\n\n**URL Parameters**:\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| id | string | Venue ID (UUID) |\n\n**Response (200 OK)**:\n```json\n{\n  \"venue_id\": \"uuid-1234\",\n  \"venue_name\": \"Elite Basketball Court\",\n  \"description\": \"Professional-grade indoor basketball court...\",\n  \"location\": \"123 Sports Avenue, Downtown District\",\n  \"coordinates\": {\n    \"latitude\": 40.7128,\n    \"longitude\": -74.0060\n  },\n  \"price_per_hour\": 40,\n  \"amenities\": [\n    \"Changing Rooms\",\n    \"Parking Available\",\n    \"Equipment Rental\",\n    \"Shower Facilities\"\n  ],\n  \"images\": [\n    \"https://example.com/image1.jpg\",\n    \"https://example.com/image2.jpg\"\n  ],\n  \"available_times\": [\n    \"08:00\", \"09:00\", \"10:00\", /* ... */\n  ],\n  \"rating\": 4.5,\n  \"total_reviews\": 234\n}\n```\n\n**Error Responses**:\n- `404 Not Found`: Venue doesn't exist\n- `500 Internal Server Error`: Server error\n\n---\n\n### 2. Users API\n\n#### User Login\n```\nPOST /users/login\n```\n\n**Description**: Authenticate user with email and password\n\n**Headers**:\n```\nContent-Type: application/json\n```\n\n**Request Body**:\n```json\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\"\n}\n```\n\n**Response (200 OK)**:\n```json\n{\n  \"user_id\": \"uuid-5678\",\n  \"email\": \"user@example.com\",\n  \"full_name\": \"John Doe\",\n  \"message\": \"Login successful\"\n}\n```\n\n**Error Responses**:\n- `400 Bad Request`: Missing email or password\n- `401 Unauthorized`: Invalid credentials\n- `500 Internal Server Error`: Server error\n\n**Special Notes**:\n- Uses `credentials: 'include'` to send/receive HTTP-only cookies\n- Session cookie is automatically set by backend\n- Must maintain credentials in subsequent API calls\n\n**Used In**: `Login.jsx`\n\n**Example Usage**:\n```javascript\nconst response = await fetch(\"http://localhost:3000/api/users/login\", {\n  method: \"POST\",\n  credentials: \"include\", // IMPORTANT: Include credentials\n  headers: { \"Content-Type\": \"application/json\" },\n  body: JSON.stringify({\n    email: \"user@example.com\",\n    password: \"securePassword123\"\n  })\n});\n\nconst data = await response.json();\nif (response.ok) {\n  navigate(\"/\");\n} else {\n  alert(data.message || \"Login failed\");\n}\n```\n\n---\n\n#### User Registration (To Implement)\n```\nPOST /users/signup\n```\n\n**Description**: Create a new user account\n\n**Headers**:\n```\nContent-Type: application/json\n```\n\n**Request Body**:\n```json\n{\n  \"full_name\": \"John Doe\",\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\"\n}\n```\n\n**Response (201 Created)**:\n```json\n{\n  \"user_id\": \"uuid-5678\",\n  \"email\": \"user@example.com\",\n  \"full_name\": \"John Doe\",\n  \"message\": \"Account created successfully\"\n}\n```\n\n**Error Responses**:\n- `400 Bad Request`: Invalid input (missing fields, password too short)\n- `409 Conflict`: Email already registered\n- `500 Internal Server Error`: Server error\n\n**Validation Requirements**:\n- Email must be valid format\n- Password must be minimum 8 characters\n- Full name must not be empty\n\n---\n\n#### User Logout (To Implement)\n```\nPOST /users/logout\n```\n\n**Description**: End user session\n\n**Headers**:\n```\nContent-Type: application/json\n```\n\n**Response (200 OK)**:\n```json\n{\n  \"message\": \"Logged out successfully\"\n}\n```\n\n---\n\n### 3. Bookings API (To Implement)\n\n#### Create Booking\n```\nPOST /bookings\n```\n\n**Description**: Create a new venue booking\n\n**Authentication**: Required (session cookie)\n\n**Headers**:\n```\nContent-Type: application/json\nCookie: session_id=...\n```\n\n**Request Body**:\n```json\n{\n  \"venue_id\": \"uuid-1234\",\n  \"booking_date\": \"2025-12-01\",\n  \"start_time\": \"14:00\",\n  \"duration_hours\": 2,\n  \"total_price\": 80\n}\n```\n\n**Response (201 Created)**:\n```json\n{\n  \"booking_id\": \"uuid-9999\",\n  \"venue_id\": \"uuid-1234\",\n  \"user_id\": \"uuid-5678\",\n  \"booking_date\": \"2025-12-01\",\n  \"start_time\": \"14:00\",\n  \"end_time\": \"16:00\",\n  \"duration_hours\": 2,\n  \"total_price\": 80,\n  \"status\": \"confirmed\",\n  \"created_at\": \"2025-11-25T10:30:00Z\"\n}\n```\n\n**Error Responses**:\n- `400 Bad Request`: Invalid booking data\n- `401 Unauthorized`: User not authenticated\n- `409 Conflict`: Time slot already booked\n- `422 Unprocessable Entity`: Booking in the past\n- `500 Internal Server Error`: Server error\n\n---\n\n#### Get User Bookings\n```\nGET /bookings\n```\n\n**Description**: Retrieve all bookings for authenticated user\n\n**Authentication**: Required (session cookie)\n\n**Query Parameters**:\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| status | string | No | Filter by status: 'confirmed', 'cancelled', 'completed' |\n| limit | number | No | Number of results (default: 20) |\n| offset | number | No | Pagination offset (default: 0) |\n\n**Response (200 OK)**:\n```json\n{\n  \"bookings\": [\n    {\n      \"booking_id\": \"uuid-9999\",\n      \"venue_name\": \"Elite Basketball Court\",\n      \"booking_date\": \"2025-12-01\",\n      \"start_time\": \"14:00\",\n      \"duration_hours\": 2,\n      \"total_price\": 80,\n      \"status\": \"confirmed\"\n    }\n  ],\n  \"total\": 10,\n  \"limit\": 20,\n  \"offset\": 0\n}\n```\n\n---\n\n#### Cancel Booking\n```\nDELETE /bookings/:id\n```\n\n**Description**: Cancel an existing booking\n\n**Authentication**: Required (session cookie)\n\n**URL Parameters**:\n| Parameter | Type | Description |\n|-----------|------|-------------|\n| id | string | Booking ID |\n\n**Response (200 OK)**:\n```json\n{\n  \"message\": \"Booking cancelled successfully\",\n  \"refund_amount\": 80,\n  \"refund_status\": \"pending\"\n}\n```\n\n**Error Responses**:\n- `401 Unauthorized`: User not authenticated\n- `404 Not Found`: Booking not found\n- `409 Conflict`: Cannot cancel - booking is in progress or completed\n- `500 Internal Server Error`: Server error\n\n---\n\n## Error Handling\n\n### Standard Error Response Format\n```json\n{\n  \"error\": true,\n  \"message\": \"User-friendly error message\",\n  \"code\": \"ERROR_CODE\",\n  \"timestamp\": \"2025-11-25T10:30:00Z\"\n}\n```\n\n### HTTP Status Codes\n| Code | Meaning | Common Causes |\n|------|---------|---------------|\n| 200 | OK | Request successful |\n| 201 | Created | Resource created successfully |\n| 400 | Bad Request | Invalid input data |\n| 401 | Unauthorized | Not authenticated or invalid credentials |\n| 403 | Forbidden | Authenticated but not allowed |\n| 404 | Not Found | Resource doesn't exist |\n| 409 | Conflict | Resource conflict (e.g., duplicate email) |\n| 422 | Unprocessable Entity | Validation error |\n| 500 | Server Error | Backend error |\n| 503 | Service Unavailable | Server down or under maintenance |\n\n---\n\n## Frontend Implementation Patterns\n\n### Fetching Data with Axios\n\n```javascript\n// GET request\nconst fetchVenues = async () => {\n  try {\n    setLoading(true);\n    setError(null);\n    const response = await axios.get(\"http://localhost:3000/api/venues\");\n    setVenues(response.data);\n  } catch (err) {\n    console.error(\"Error fetching venues:\", err);\n    setError(\"Failed to fetch venues. Please try again.\");\n  } finally {\n    setLoading(false);\n  }\n};\n\n// GET with search parameters\nconst searchVenues = async (searchText) => {\n  try {\n    const response = await axios.get(\"http://localhost:3000/api/venues\", {\n      params: { search: searchText }\n    });\n    return response.data;\n  } catch (err) {\n    console.error(\"Error searching venues:\", err);\n    throw err;\n  }\n};\n```\n\n### Authentication Pattern\n\n```javascript\n// Login request\nconst handleLogin = async (email, password) => {\n  try {\n    const response = await fetch(\"http://localhost:3000/api/users/login\", {\n      method: \"POST\",\n      credentials: \"include\", // Important: maintains session\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ email, password })\n    });\n    \n    const data = await response.json();\n    \n    if (!response.ok) {\n      throw new Error(data.message || \"Login failed\");\n    }\n    \n    navigate(\"/\");\n  } catch (err) {\n    setError(err.message);\n  }\n};\n```\n\n### Error Handling Pattern\n\n```javascript\nconst makeAPICall = async () => {\n  try {\n    const response = await axios.post(\"/endpoint\", data);\n    // Success handling\n    return response.data;\n  } catch (error) {\n    // Handle different error types\n    if (error.response) {\n      // Server responded with error status\n      console.error(\"Error:\", error.response.status, error.response.data);\n      setError(error.response.data.message || \"Request failed\");\n    } else if (error.request) {\n      // Request made but no response\n      console.error(\"No response from server\");\n      setError(\"No response from server. Please check your connection.\");\n    } else {\n      // Error setting up request\n      console.error(\"Error:\", error.message);\n      setError(\"An error occurred. Please try again.\");\n    }\n  }\n};\n```\n\n---\n\n## Environment Configuration\n\n### Development\n```\nVITE_API_BASE_URL=http://localhost:3000/api\nVITE_ENV=development\n```\n\n### Production\n```\nVITE_API_BASE_URL=https://api.playlink.com\nVITE_ENV=production\n```\n\n### Using Environment Variables\n\n```javascript\nconst API_BASE_URL = import.meta.env.VITE_API_BASE_URL;\n\nconst response = await axios.get(`${API_BASE_URL}/venues`);\n```\n\n---\n\n## Rate Limiting\n\n- **General endpoints**: 100 requests per minute per IP\n- **Auth endpoints**: 5 requests per minute per IP\n- **Search endpoint**: 50 requests per minute per user\n\n**Response Header**: `X-RateLimit-Remaining: 45`\n**Error**: HTTP 429 Too Many Requests\n\n---\n\n## CORS Configuration\n\nBackend should allow:\n- **Origin**: `http://localhost:3000` (dev), `https://playlink.com` (prod)\n- **Credentials**: `true` (for session cookies)\n- **Methods**: GET, POST, DELETE, PUT, OPTIONS\n- **Headers**: Content-Type, Authorization\n\n---\n\n## Future Enhancements\n\n1. **JWT Authentication**: Replace session cookies with JWT tokens\n2. **Refresh Tokens**: Implement token refresh mechanism\n3. **Pagination**: Add pagination to list endpoints\n4. **Filtering**: Advanced filtering options\n5. **Sorting**: Sort results by price, rating, distance\n6. **Webhooks**: Real-time notifications for bookings\n7. **File Upload**: Support for venue images\n8. **Search Analytics**: Track popular searches\n\n---\n\n## Testing the API\n\n### Using cURL\n\n```bash\n# Get all venues\ncurl http://localhost:3000/api/venues\n\n# Search venues\ncurl \"http://localhost:3000/api/venues?search=basketball\"\n\n# Get trending venues\ncurl http://localhost:3000/api/venues/top-weekly\n\n# Login\ncurl -X POST http://localhost:3000/api/users/login \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"email\":\"user@example.com\",\"password\":\"password123\"}' \\\n  -c cookies.txt\n```\n\n### Using Postman\n\n1. Import API collection (if available)\n2. Set up environment variables for base URL\n3. Configure authentication (cookies/sessions)\n4. Test endpoints with sample data\n\n### Using Browser DevTools\n\n1. Open Network tab in DevTools\n2. Check API requests and responses\n3. Verify request headers (Content-Type, cookies)\n4. Check response status codes and data\n\n---\n\n## Support & Troubleshooting\n\n**Issue**: CORS errors\n**Solution**: Check backend CORS configuration, ensure credentials are included\n\n**Issue**: 401 Unauthorized\n**Solution**: Make sure user is logged in, session cookie is valid\n\n**Issue**: 409 Conflict on booking\n**Solution**: Time slot may already be booked, try different time\n\n**Issue**: Slow API responses\n**Solution**: Check network connection, server status, database queries\n\nFor more support: support@playlink.example\n